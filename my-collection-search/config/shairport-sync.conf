// Shairport Sync Configuration
// This file configures the AirPlay receiver for your USB DAC

general = {
  // AirPlay device name (what shows up in iOS/Mac AirPlay menu)
  // Overridden by AIRPLAY_NAME environment variable if set
  name = "GrooveNET Audio";

  // Interpolation method (basic, soxr, or auto)
  // soxr provides best quality but uses more CPU
  interpolation = "soxr";

  // Output backend (alsa for USB DAC)
  output_backend = "alsa";

  // Run as daemon in foreground (required for Docker)
  daemon = "no";

  // Port for RTSP (default 5000)
  port = 5000;

  // UDP port range for audio
  udp_port_base = 6001;
  udp_port_range = 10;
};

// ALSA audio backend configuration
alsa = {
  // EXCLUSIVE MODE: Direct hardware access
  // Only one application can use the DAC at a time
  // App playback and AirPlay will interrupt each other
  output_device = "plughw:1,0";  // Change '1' to your USB DAC card number

  // Mixer control device (for volume control)
  mixer_control_name = "PCM";

  // Enable hardware mixer
  mixer_type = "hardware";

  // Optional: Use software mixer if hardware mixer isn't available
  // mixer_type = "software";
};

// Session control
sessioncontrol = {
  // Run command when AirPlay session starts
  // Pauses the Next.js app playback automatically
  run_this_before_play_begins = "/usr/local/bin/airplay-session-start.sh";

  // Run command when AirPlay session ends
  run_this_after_play_ends = "/usr/local/bin/airplay-session-end.sh";

  // Wait for completion before starting playback
  wait_for_completion = "yes";

  // Allow session interruption (other AirPlay devices can take over)
  allow_session_interruption = "yes";

  // Session timeout in seconds
  session_timeout = 120;
};

// Metadata (song info from AirPlay source)
metadata = {
  enabled = "yes";

  // Optionally pipe metadata to a program
  // This could be used to display now playing info on the web UI
  // pipe_name = "/tmp/shairport-sync-metadata";
  // pipe_timeout = 5000;
};

// Diagnostics
diagnostics = {
  // Disable statistics logging (reduces noise)
  disable_statistics = "no";
};
